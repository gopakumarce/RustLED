use std::thread;
use std::time::Duration;
mod platform_libs;
use log::info;

pub fn blink_leds() {
    loop {
        info!("Sleeping..");
        thread::sleep(Duration::from_secs(30));
    }
}

fn main() -> anyhow::Result<()> {
    println!("Initializing RustLED");
    platform_libs::platform_init(&[4])?;
    let r = [
        0x00000000, 0x00000001, 0x00000003, 0x00000004, 0x00000005, 0x00000007, 0x00000008,
        0x0000000a, 0x0000000b, 0x0000000d, 0x0000000e, 0x0000000f, 0x00000011, 0x00000012,
        0x00000013, 0x00000015, 0x00000016, 0x00000018, 0x00000019, 0x0000001b, 0x0000001c,
        0x0000001e, 0x0000001f, 0x00000020, 0x00000022, 0x00000023, 0x00000024, 0x00000026,
        0x00000027, 0x00000029, 0x0000002a, 0x0000002b, 0x0000002c, 0x0000002b, 0x00000029,
        0x00000028, 0x00000026, 0x00000025, 0x00000024, 0x00000022, 0x00000021, 0x0000001f,
        0x0000001e, 0x0000001c, 0x00000019, 0x00000016, 0x00000013, 0x00000010, 0x0000000e,
        0x0000000b,
    ];
    let g = [
        0x00000040, 0x0000003e, 0x0000003c, 0x00000039, 0x00000037, 0x00000036, 0x00000034,
        0x00000032, 0x0000002f, 0x0000002d, 0x0000002b, 0x0000002b, 0x0000002b, 0x0000002b,
        0x0000002b, 0x0000002b, 0x0000002b, 0x0000002b, 0x0000002b, 0x0000002b, 0x0000002b,
        0x0000002b, 0x00000027, 0x00000023, 0x0000001e, 0x0000001a, 0x00000016, 0x00000013,
        0x0000000e, 0x0000000a, 0x00000006, 0x00000002, 0x00000000, 0x00000000, 0x00000000,
        0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
        0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
        0x00000000,
    ];
    let b = [
        0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
        0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
        0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
        0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
        0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000002, 0x00000004,
        0x00000006, 0x00000008, 0x0000000a, 0x0000000b, 0x0000000d, 0x0000000f, 0x00000011,
        0x00000013, 0x00000016, 0x0000001a, 0x0000001e, 0x00000022, 0x00000025, 0x00000029,
        0x0000002d,
    ];
    let mut colors = vec![vec![]];
    colors[0].push(r.to_vec());
    colors[0].push(g.to_vec());
    colors[0].push(b.to_vec());
    unsafe { platform_libs::show_pixels(colors) };
    blink_leds();
    Ok(())
}
